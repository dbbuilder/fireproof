import{j as l}from"./vendor-8rVgzruD.js";import{i as c}from"./index-DcSKaWik.js";const d=l("inspectionsPhase1",{state:()=>({inspections:[],currentInspection:null,checklistResponses:{},stats:null,loading:!1,error:null}),getters:{inspectionCount:e=>e.inspections.length,getInspectionById:e=>t=>e.inspections.find(i=>i.inspectionId===t),getInspectionsByStatus:e=>t=>e.inspections.filter(i=>i.status===t),inspectionsByStatus:e=>{const t={};return e.inspections.forEach(i=>{const s=i.status;t[s]||(t[s]=[]),t[s].push(i)}),t},inProgressInspections:e=>e.inspections.filter(t=>t.status==="InProgress"),completedInspections:e=>e.inspections.filter(t=>t.status==="Completed"),scheduledInspections:e=>e.inspections.filter(t=>t.status==="Scheduled"),passedInspections:e=>e.inspections.filter(t=>t.overallResult==="Pass"),failedInspections:e=>e.inspections.filter(t=>t.overallResult==="Fail"),getResponsesForInspection:e=>t=>e.checklistResponses[t]},actions:{async fetchInspections(e={}){var t,i;this.loading=!0,this.error=null;try{this.inspections=await c.getAll(e)}catch(s){throw this.error=((i=(t=s.response)==null?void 0:t.data)==null?void 0:i.message)||"Failed to fetch inspections",console.error("Error fetching inspections:",s),s}finally{this.loading=!1}},async fetchInspectionById(e,t=!0){var i,s;this.loading=!0,this.error=null;try{return this.currentInspection=await c.getById(e,t),this.currentInspection.checklistResponses&&(this.checklistResponses[e]=this.currentInspection.checklistResponses),this.currentInspection}catch(n){throw this.error=((s=(i=n.response)==null?void 0:i.data)==null?void 0:s.message)||"Failed to fetch inspection",console.error("Error fetching inspection:",n),n}finally{this.loading=!1}},async createInspection(e){var t,i;this.loading=!0,this.error=null;try{const s=await c.create(e);return this.inspections.push(s),this.currentInspection=s,s}catch(s){throw this.error=((i=(t=s.response)==null?void 0:t.data)==null?void 0:i.message)||"Failed to create inspection",console.error("Error creating inspection:",s),s}finally{this.loading=!1}},async updateInspection(e,t){var i,s,n;this.loading=!0,this.error=null;try{const r=await c.update(e,t),o=this.inspections.findIndex(a=>a.inspectionId===e);return o!==-1&&(this.inspections[o]=r),((i=this.currentInspection)==null?void 0:i.inspectionId)===e&&(this.currentInspection=r),r}catch(r){throw this.error=((n=(s=r.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to update inspection",console.error("Error updating inspection:",r),r}finally{this.loading=!1}},async completeInspection(e,t){var i,s,n;this.loading=!0,this.error=null;try{const r=await c.complete(e,t),o=this.inspections.findIndex(a=>a.inspectionId===e);return o!==-1&&(this.inspections[o]=r),((i=this.currentInspection)==null?void 0:i.inspectionId)===e&&(this.currentInspection=r),r}catch(r){throw this.error=((n=(s=r.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to complete inspection",console.error("Error completing inspection:",r),r}finally{this.loading=!1}},async deleteInspection(e){var t,i,s;this.loading=!0,this.error=null;try{await c.delete(e),this.inspections=this.inspections.filter(n=>n.inspectionId!==e),((t=this.currentInspection)==null?void 0:t.inspectionId)===e&&(this.currentInspection=null),delete this.checklistResponses[e]}catch(n){throw this.error=((s=(i=n.response)==null?void 0:i.data)==null?void 0:s.message)||"Failed to delete inspection",console.error("Error deleting inspection:",n),n}finally{this.loading=!1}},async saveChecklistResponses(e,t){var i,s;this.loading=!0,this.error=null;try{const n=await c.saveChecklistResponses(e,t);return this.checklistResponses[e]=n,n}catch(n){throw this.error=((s=(i=n.response)==null?void 0:i.data)==null?void 0:s.message)||"Failed to save checklist responses",console.error("Error saving checklist responses:",n),n}finally{this.loading=!1}},async fetchChecklistResponses(e){var t,i;this.loading=!0,this.error=null;try{const s=await c.getChecklistResponses(e);return this.checklistResponses[e]=s,s}catch(s){throw this.error=((i=(t=s.response)==null?void 0:t.data)==null?void 0:i.message)||"Failed to fetch checklist responses",console.error("Error fetching checklist responses:",s),s}finally{this.loading=!1}},async fetchExtinguisherHistory(e,t=20){var i,s;this.loading=!0,this.error=null;try{const n=await c.getExtinguisherHistory(e,t);return n.forEach(r=>{const o=this.inspections.findIndex(a=>a.inspectionId===r.inspectionId);o===-1?this.inspections.push(r):this.inspections[o]=r}),n}catch(n){throw this.error=((s=(i=n.response)==null?void 0:i.data)==null?void 0:s.message)||"Failed to fetch extinguisher history",console.error("Error fetching extinguisher history:",n),n}finally{this.loading=!1}},async fetchInspectorInspections(e,t={}){var i,s;this.loading=!0,this.error=null;try{const n=await c.getInspectorInspections(e,t);return n.forEach(r=>{const o=this.inspections.findIndex(a=>a.inspectionId===r.inspectionId);o===-1?this.inspections.push(r):this.inspections[o]=r}),n}catch(n){throw this.error=((s=(i=n.response)==null?void 0:i.data)==null?void 0:s.message)||"Failed to fetch inspector inspections",console.error("Error fetching inspector inspections:",n),n}finally{this.loading=!1}},async fetchDueInspections(e,t){var i,s;this.loading=!0,this.error=null;try{const n=await c.getDueInspections(e,t);return n.forEach(r=>{const o=this.inspections.findIndex(a=>a.inspectionId===r.inspectionId);o===-1?this.inspections.push(r):this.inspections[o]=r}),n}catch(n){throw this.error=((s=(i=n.response)==null?void 0:i.data)==null?void 0:s.message)||"Failed to fetch due inspections",console.error("Error fetching due inspections:",n),n}finally{this.loading=!1}},async fetchScheduledInspections(e,t){var i,s;this.loading=!0,this.error=null;try{const n=await c.getScheduledInspections(e,t);return n.forEach(r=>{const o=this.inspections.findIndex(a=>a.inspectionId===r.inspectionId);o===-1?this.inspections.push(r):this.inspections[o]=r}),n}catch(n){throw this.error=((s=(i=n.response)==null?void 0:i.data)==null?void 0:s.message)||"Failed to fetch scheduled inspections",console.error("Error fetching scheduled inspections:",n),n}finally{this.loading=!1}},async verifyIntegrity(e){var t,i;this.loading=!0,this.error=null;try{return await c.verifyIntegrity(e)}catch(s){throw this.error=((i=(t=s.response)==null?void 0:t.data)==null?void 0:i.message)||"Failed to verify inspection integrity",console.error("Error verifying inspection integrity:",s),s}finally{this.loading=!1}},async fetchStats(e,t,i){var s,n;this.loading=!0,this.error=null;try{return this.stats=await c.getStats(e,t,i),this.stats}catch(r){throw this.error=((n=(s=r.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to fetch inspection stats",console.error("Error fetching inspection stats:",r),r}finally{this.loading=!1}},clearError(){this.error=null}}});export{d as u};
