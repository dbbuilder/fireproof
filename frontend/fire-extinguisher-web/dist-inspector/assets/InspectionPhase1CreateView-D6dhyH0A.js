import{d as Q,r as m,c as N,o as R,b as l,f as e,h as H,x as U,i as q,e as b,A as p,p as D,s as G,q as J,v as K,F as T,E as L,t as r,u as O,g as i}from"./vendor-8rVgzruD.js";import{u as W}from"./extinguishers-BkjuEnvJ.js";import{u as X}from"./checklistTemplates-CAJuC8xZ.js";import{u as Y}from"./inspectionsPhase1-lLNUs6w2.js";import{a as Z}from"./index-DcSKaWik.js";const ee={class:"min-h-screen bg-gray-50"},te={class:"bg-white border-b border-gray-200 sticky top-0 z-10"},se={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},oe={class:"flex items-center justify-between h-16"},re={class:"max-w-2xl mx-auto px-4 py-6 sm:px-6 lg:px-8"},ae={class:"mb-6"},le={class:"flex items-center justify-center space-x-4"},ie={key:0,class:"animate-fade-in"},ne={class:"bg-white rounded-lg shadow-soft p-6"},de={class:"mt-4"},ue={class:"mt-4 space-y-2 max-h-96 overflow-y-auto"},ce=["onClick"],me={class:"flex justify-between items-start"},pe={class:"font-medium text-gray-900"},ve={class:"text-sm text-gray-600"},ge={class:"text-xs text-gray-500"},ye={key:0,class:"text-center py-8 text-gray-500"},xe={key:1,class:"animate-fade-in"},be={class:"bg-white rounded-lg shadow-soft p-6"},he={class:"space-y-3"},fe=["onClick"],we={class:"flex justify-between items-start"},_e={class:"flex-1"},ke={class:"font-medium text-gray-900"},Ce={class:"text-sm text-gray-600 mt-1"},Ie={class:"text-xs text-gray-500 mt-1"},Se={key:0,class:"text-sm text-gray-600 mt-2"},Ne={key:2,class:"animate-fade-in"},Te={class:"bg-white rounded-lg shadow-soft p-6"},Le={class:"space-y-4"},je={class:"p-4 bg-gray-50 rounded-lg"},Me={class:"font-medium text-gray-900"},Be={class:"text-sm text-gray-600"},Ee={class:"p-4 bg-gray-50 rounded-lg"},Ve={class:"font-medium text-gray-900"},ze={class:"text-sm text-gray-600"},Fe={class:"p-4 bg-gray-50 rounded-lg"},Pe={class:"flex items-center justify-between mb-2"},$e=["disabled"],Ae={key:0,class:"text-sm text-gray-900"},Qe={key:1,class:"text-sm text-gray-500"},Re={class:"mt-6 space-y-3"},He=["disabled"],Ue=["disabled"],qe={key:3,class:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg"},De={class:"flex"},Ge={class:"text-sm text-red-800"},Ze=Q({__name:"InspectionPhase1CreateView",setup(Je){const j=O(),_=W(),k=X(),M=Y(),B=Z(),a=m(1),f=m(""),g=m(null),y=m(null),v=m(null),w=m(!1),h=m(!1),n=m(null),C=N(()=>{if(!f.value)return _.extinguishers;const s=f.value.toLowerCase();return _.extinguishers.filter(t=>{var d,u,c;return((d=t.assetTag)==null?void 0:d.toLowerCase().includes(s))||t.extinguisherCode.toLowerCase().includes(s)||t.serialNumber.toLowerCase().includes(s)||((u=t.locationName)==null?void 0:u.toLowerCase().includes(s))||((c=t.typeName)==null?void 0:c.toLowerCase().includes(s))})}),E=N(()=>k.templates),V=s=>{g.value=s,a.value=2},z=s=>{y.value=s,a.value=3},F=async()=>{n.value="QR code scanning will be implemented with camera component"},P=async()=>{if(!navigator.geolocation){n.value="Geolocation is not supported by your device";return}w.value=!0,n.value=null;try{const s=await new Promise((t,d)=>{navigator.geolocation.getCurrentPosition(t,d,{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})});v.value={latitude:s.coords.latitude,longitude:s.coords.longitude}}catch(s){n.value=`Failed to capture location: ${s.message}`}finally{w.value=!1}},$=async()=>{var s,t,d,u,c;if(!g.value||!y.value){n.value="Please select extinguisher and template";return}h.value=!0,n.value=null;try{const x=await M.createInspection({extinguisherId:g.value.extinguisherId,inspectorUserId:((s=B.user)==null?void 0:s.userId)||"",templateId:y.value.templateId,inspectionType:y.value.inspectionType,latitude:((t=v.value)==null?void 0:t.latitude)||null,longitude:((d=v.value)==null?void 0:d.longitude)||null});j.push(`/inspections/${x.inspectionId}/checklist`)}catch(x){n.value=((c=(u=x.response)==null?void 0:u.data)==null?void 0:c.message)||"Failed to create inspection"}finally{h.value=!1}};return R(async()=>{try{await Promise.all([_.fetchExtinguishers(),k.fetchTenantTemplates()])}catch{n.value="Failed to load data"}}),(s,t)=>{var u,c,x,I,S;const d=q("router-link");return i(),l("div",ee,[e("div",te,[e("div",se,[e("div",oe,[H(d,{to:"/inspections",class:"flex items-center text-gray-600 hover:text-gray-900"},{default:U(()=>[...t[3]||(t[3]=[e("svg",{class:"h-6 w-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),e("span",{class:"font-medium"},"Back",-1)])]),_:1}),t[4]||(t[4]=e("h1",{class:"text-lg font-semibold text-gray-900"}," New Inspection ",-1)),t[5]||(t[5]=e("div",{class:"w-20"},null,-1))])])]),e("div",re,[e("div",ae,[e("div",le,[e("div",{class:p(["flex items-center",a.value>=1?"text-primary-600":"text-gray-400"])},[e("div",{class:p(["flex items-center justify-center w-10 h-10 rounded-full border-2",a.value>=1?"border-primary-600 bg-primary-50":"border-gray-300"])},[...t[6]||(t[6]=[e("span",{class:"text-sm font-semibold"},"1",-1)])],2),t[7]||(t[7]=e("span",{class:"ml-2 text-sm font-medium hidden sm:inline"},"Extinguisher",-1))],2),e("div",{class:p(["w-12 h-0.5",a.value>=2?"bg-primary-600":"bg-gray-300"])},null,2),e("div",{class:p(["flex items-center",a.value>=2?"text-primary-600":"text-gray-400"])},[e("div",{class:p(["flex items-center justify-center w-10 h-10 rounded-full border-2",a.value>=2?"border-primary-600 bg-primary-50":"border-gray-300"])},[...t[8]||(t[8]=[e("span",{class:"text-sm font-semibold"},"2",-1)])],2),t[9]||(t[9]=e("span",{class:"ml-2 text-sm font-medium hidden sm:inline"},"Template",-1))],2),e("div",{class:p(["w-12 h-0.5",a.value>=3?"bg-primary-600":"bg-gray-300"])},null,2),e("div",{class:p(["flex items-center",a.value>=3?"text-primary-600":"text-gray-400"])},[e("div",{class:p(["flex items-center justify-center w-10 h-10 rounded-full border-2",a.value>=3?"border-primary-600 bg-primary-50":"border-gray-300"])},[...t[10]||(t[10]=[e("span",{class:"text-sm font-semibold"},"3",-1)])],2),t[11]||(t[11]=e("span",{class:"ml-2 text-sm font-medium hidden sm:inline"},"Start",-1))],2)])]),a.value===1?(i(),l("div",ie,[e("div",ne,[t[15]||(t[15]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-4"}," Select Extinguisher ",-1)),e("button",{class:"w-full mb-4 flex items-center justify-center px-4 py-3 border-2 border-dashed border-gray-300 rounded-lg text-gray-700 hover:border-primary-500 hover:bg-primary-50 transition-colors",onClick:F},[...t[12]||(t[12]=[e("svg",{class:"h-6 w-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})],-1),G(" Scan Barcode/QR Code ",-1)])]),t[16]||(t[16]=D('<div class="relative"><div class="absolute inset-0 flex items-center"><div class="w-full border-t border-gray-300"></div></div><div class="relative flex justify-center text-sm"><span class="px-2 bg-white text-gray-500">or select manually</span></div></div>',1)),e("div",de,[t[13]||(t[13]=e("label",{for:"search",class:"block text-sm font-medium text-gray-700 mb-1"},"Search",-1)),J(e("input",{id:"search","onUpdate:modelValue":t[0]||(t[0]=o=>f.value=o),type:"text",placeholder:"Asset tag, location, serial...",class:"w-full rounded-lg border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500"},null,512),[[K,f.value]])]),e("div",ue,[(i(!0),l(T,null,L(C.value,o=>(i(),l("div",{key:o.extinguisherId,class:"p-4 border border-gray-200 rounded-lg cursor-pointer hover:border-primary-500 hover:bg-primary-50 transition-colors",onClick:A=>V(o)},[e("div",me,[e("div",null,[e("p",pe,r(o.assetTag||o.extinguisherCode),1),e("p",ve,r(o.locationName),1),e("p",ge,r(o.typeName)+" â€¢ "+r(o.serialNumber),1)]),t[14]||(t[14]=e("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))])],8,ce))),128)),C.value.length===0?(i(),l("div",ye," No extinguishers found ")):b("",!0)])])])):b("",!0),a.value===2?(i(),l("div",xe,[e("div",be,[t[18]||(t[18]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-4"}," Select Inspection Type ",-1)),e("div",he,[(i(!0),l(T,null,L(E.value,o=>(i(),l("div",{key:o.templateId,class:"p-4 border border-gray-200 rounded-lg cursor-pointer hover:border-primary-500 hover:bg-primary-50 transition-colors",onClick:A=>z(o)},[e("div",we,[e("div",_e,[e("p",ke,r(o.templateName),1),e("p",Ce,r(o.inspectionType),1),e("p",Ie,r(o.standard),1),o.description?(i(),l("p",Se,r(o.description),1)):b("",!0)]),t[17]||(t[17]=e("svg",{class:"h-5 w-5 text-gray-400 ml-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))])],8,fe))),128))]),e("button",{class:"mt-6 w-full px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",onClick:t[1]||(t[1]=o=>a.value=1)}," Back ")])])):b("",!0),a.value===3?(i(),l("div",Ne,[e("div",Te,[t[22]||(t[22]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-4"}," Confirm Inspection ",-1)),e("div",Le,[e("div",je,[t[19]||(t[19]=e("p",{class:"text-sm text-gray-600 mb-1"}," Extinguisher ",-1)),e("p",Me,r(((u=g.value)==null?void 0:u.assetTag)||((c=g.value)==null?void 0:c.extinguisherCode)),1),e("p",Be,r((x=g.value)==null?void 0:x.locationName),1)]),e("div",Ee,[t[20]||(t[20]=e("p",{class:"text-sm text-gray-600 mb-1"}," Inspection Type ",-1)),e("p",Ve,r((I=y.value)==null?void 0:I.templateName),1),e("p",ze,r((S=y.value)==null?void 0:S.inspectionType),1)]),e("div",Fe,[e("div",Pe,[t[21]||(t[21]=e("p",{class:"text-sm text-gray-600"}," GPS Location ",-1)),e("button",{disabled:w.value,class:"text-sm text-primary-600 hover:text-primary-700 disabled:text-gray-400",onClick:P},r(w.value?"Capturing...":v.value?"Update":"Capture"),9,$e)]),v.value?(i(),l("p",Ae,r(v.value.latitude.toFixed(6))+", "+r(v.value.longitude.toFixed(6)),1)):(i(),l("p",Qe," Not captured "))])]),e("div",Re,[e("button",{disabled:h.value,class:"w-full px-6 py-3 bg-primary-600 text-white rounded-lg font-medium hover:bg-primary-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors shadow-sm",onClick:$},r(h.value?"Starting...":"Start Inspection"),9,He),e("button",{disabled:h.value,class:"w-full px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed",onClick:t[2]||(t[2]=o=>a.value=2)}," Back ",8,Ue)])])])):b("",!0),n.value?(i(),l("div",qe,[e("div",De,[t[23]||(t[23]=e("svg",{class:"h-5 w-5 text-red-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),e("p",Ge,r(n.value),1)])])):b("",!0)])])}}});export{Ze as default};
