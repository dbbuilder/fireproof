import{r as k,c as g,o as B,u as M,b as u,f as s,e as C,t as r,D as E,F as N,E as A,A as c,g as p,q as S,v as V}from"./vendor-8rVgzruD.js";import{u as z}from"./index-DcSKaWik.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";const L={class:"inspection-checklist"},D={class:"context-summary","data-testid":"context-summary"},R={class:"context-row"},O={class:"context-value","data-testid":"context-location"},T={class:"context-row"},q={class:"context-value","data-testid":"context-extinguisher"},H={class:"progress-section"},U={class:"progress-bar-container"},W={class:"progress-text","data-testid":"progress-text"},Y={class:"checklist-items"},j=["data-testid"],G={class:"item-header"},J={class:"item-number"},K=["data-testid"],Q={class:"item-responses"},X=["onClick","data-testid"],Z=["onClick","data-testid"],ss=["onClick","data-testid"],es={key:0,class:"item-notes"},ts=["onUpdate:modelValue","data-testid"],ns={class:"overall-assessment","data-testid":"overall-assessment"},os={class:"assessment-buttons"},is={key:0,class:"alert-error","data-testid":"validation-error"},as={__name:"InspectionChecklistView",setup(ls){const b=M(),v=z(),i=k([{id:1,description:"Extinguisher is accessible and visible (not blocked)",response:null,notes:""},{id:2,description:"Operating instructions are legible and facing outward",response:null,notes:""},{id:3,description:"Tamper seal is intact and unbroken",response:null,notes:""},{id:4,description:"Pressure gauge shows proper pressure (green zone)",response:null,notes:""},{id:5,description:"Inspection tag is present and current",response:null,notes:""},{id:6,description:"No physical damage, corrosion, or leakage",response:null,notes:""},{id:7,description:"Hose and nozzle are in good condition (if applicable)",response:null,notes:""},{id:8,description:"Safety pin is intact and secure",response:null,notes:""},{id:9,description:"Extinguisher is mounted properly on wall bracket",response:null,notes:""},{id:10,description:"Signage is present and clearly visible",response:null,notes:""}]),d=k(null),a=k(""),x=g(()=>v.currentLocation),_=g(()=>v.currentExtinguisher),y=g(()=>i.value.filter(o=>o.response!==null).length),w=g(()=>i.value.length===0?0:Math.round(y.value/i.value.length*100)),m=(o,e)=>{const n=i.value.find(h=>h.id===o);n&&(n.response=e,e!=="fail"&&n.notes&&(n.notes="")),a.value=""},I=()=>{const o=i.value.filter(n=>n.response===null);return o.length>0?(a.value=`Please answer all checklist items (${o.length} remaining)`,!1):d.value===null?(a.value="Please select overall inspection result (Pass or Fail)",!1):i.value.filter(n=>n.response==="fail"&&!n.notes.trim()).length>0?(a.value="Please add notes for all failed items",!1):!0},$=()=>{confirm("Are you sure? Your checklist progress will be lost.")&&b.push("/inspector/scan-extinguisher")},P=()=>{if(a.value="",!I())return;const o=i.value.map(e=>({checklistItemId:e.id,description:e.description,response:e.response,notes:e.notes}));v.startInspection({overallPass:d.value,checklistResponses:o,startedAt:new Date().toISOString()}),o.forEach(e=>{v.addChecklistResponse(e)}),b.push("/inspector/inspection-photos")};return B(()=>{(!x.value||!_.value)&&(a.value="Missing inspection context. Please scan location and extinguisher first.",setTimeout(()=>{b.push("/inspector/dashboard")},3e3))}),(o,e)=>{var n,h;return p(),u("div",L,[s("div",{class:"checklist-header"},[s("button",{onClick:$,class:"btn-back","data-testid":"back-button"},[...e[2]||(e[2]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1)])]),e[3]||(e[3]=s("h1",{class:"checklist-heading","data-testid":"page-heading"},"Inspection Checklist",-1)),e[4]||(e[4]=s("div",{class:"header-spacer"},null,-1))]),s("div",D,[s("div",R,[e[5]||(e[5]=s("span",{class:"context-label"},"Location:",-1)),s("span",O,r(((n=x.value)==null?void 0:n.name)||"N/A"),1)]),s("div",T,[e[6]||(e[6]=s("span",{class:"context-label"},"Extinguisher:",-1)),s("span",q,r(((h=_.value)==null?void 0:h.serialNumber)||"N/A"),1)])]),s("div",H,[s("div",U,[s("div",{class:"progress-bar",style:E({width:`${w.value}%`}),"data-testid":"progress-bar"},null,4)]),s("div",W,r(y.value)+" of "+r(i.value.length)+" completed ",1)]),s("div",Y,[(p(!0),u(N,null,A(i.value,(t,l)=>(p(),u("div",{key:t.id,class:c(["checklist-item",{"checklist-item-completed":t.response!==null}]),"data-testid":`checklist-item-${l}`},[s("div",G,[s("div",J,r(l+1),1),s("div",{class:"item-description","data-testid":`item-description-${l}`},r(t.description),9,K)]),s("div",Q,[s("button",{onClick:f=>m(t.id,"pass"),class:c(["btn-response btn-pass",{active:t.response==="pass"}]),"data-testid":`btn-pass-${l}`},[...e[7]||(e[7]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{d:"M20 6L9 17l-5-5"})],-1),s("span",null,"Pass",-1)])],10,X),s("button",{onClick:f=>m(t.id,"fail"),class:c(["btn-response btn-fail",{active:t.response==="fail"}]),"data-testid":`btn-fail-${l}`},[...e[8]||(e[8]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1),s("span",null,"Fail",-1)])],10,Z),s("button",{onClick:f=>m(t.id,"na"),class:c(["btn-response btn-na",{active:t.response==="na"}]),"data-testid":`btn-na-${l}`},[...e[9]||(e[9]=[s("span",null,"N/A",-1)])],10,ss)]),t.response==="fail"||t.notes?(p(),u("div",es,[S(s("textarea",{"onUpdate:modelValue":f=>t.notes=f,placeholder:"Add notes (required for failures)...",class:"notes-input","data-testid":`notes-input-${l}`,rows:"2"},null,8,ts),[[V,t.notes]])])):C("",!0)],10,j))),128))]),s("div",ns,[e[12]||(e[12]=s("h2",{class:"assessment-heading"},"Overall Assessment",-1)),s("div",os,[s("button",{onClick:e[0]||(e[0]=t=>d.value=!0),class:c(["btn-assessment btn-assessment-pass",{active:d.value===!0}]),"data-testid":"btn-overall-pass"},[...e[10]||(e[10]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{d:"M22 11.08V12a10 10 0 11-5.93-9.14"}),s("polyline",{points:"22 4 12 14.01 9 11.01"})],-1),s("span",null,"Pass Inspection",-1)])],2),s("button",{onClick:e[1]||(e[1]=t=>d.value=!1),class:c(["btn-assessment btn-assessment-fail",{active:d.value===!1}]),"data-testid":"btn-overall-fail"},[...e[11]||(e[11]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("circle",{cx:"12",cy:"12",r:"10"}),s("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),s("line",{x1:"9",y1:"9",x2:"15",y2:"15"})],-1),s("span",null,"Fail Inspection",-1)])],2)])]),a.value?(p(),u("div",is,[e[13]||(e[13]=s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("circle",{cx:"12",cy:"12",r:"10"}),s("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),s("line",{x1:"9",y1:"9",x2:"15",y2:"15"})],-1)),s("span",null,r(a.value),1)])):C("",!0),s("button",{onClick:P,class:"btn-continue","data-testid":"continue-button"},[...e[14]||(e[14]=[s("span",null,"Continue to Photos",-1),s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{d:"M5 12h14M12 5l7 7-7 7"})],-1)])])])}}},us=F(as,[["__scopeId","data-v-8ca0ca4a"]]);export{us as default};
