import{j as c}from"./vendor-8rVgzruD.js";import{b as n}from"./index-DcSKaWik.js";const i={async getSystemTemplates(){return(await n.get("/checklisttemplates/system")).data},async getTenantTemplates(e=!0){const t={activeOnly:e};return(await n.get("/checklisttemplates/tenant",{params:t})).data},async getByType(e){return(await n.get(`/checklisttemplates/type/${e}`)).data},async getById(e){return(await n.get(`/checklisttemplates/${e}`)).data},async getItems(e){return(await n.get(`/checklisttemplates/${e}/items`)).data},async create(e){return(await n.post("/checklisttemplates",e)).data},async addItems(e,t){return(await n.post(`/checklisttemplates/${e}/items`,t)).data},async update(e,t){return(await n.put(`/checklisttemplates/${e}`,t)).data},async deactivate(e){await n.delete(`/checklisttemplates/${e}`)}},d=c("checklistTemplates",{state:()=>({templates:[],systemTemplates:[],currentTemplate:null,templateItems:{},loading:!1,error:null}),getters:{activeTemplates:e=>e.templates.filter(t=>t.isActive),templateCount:e=>e.templates.length,getTemplateById:e=>t=>e.templates.find(a=>a.templateId===t),getTemplatesByType:e=>t=>e.templates.filter(a=>a.inspectionType===t),templatesByType:e=>{const t={};return e.templates.forEach(a=>{const s=a.inspectionType;t[s]||(t[s]=[]),t[s].push(a)}),t},getItemsForTemplate:e=>t=>e.templateItems[t]},actions:{async fetchSystemTemplates(){var e,t;this.loading=!0,this.error=null;try{this.systemTemplates=await i.getSystemTemplates()}catch(a){throw this.error=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to fetch system templates",console.error("Error fetching system templates:",a),a}finally{this.loading=!1}},async fetchTenantTemplates(e=!0){var t,a;this.loading=!0,this.error=null;try{this.templates=await i.getTenantTemplates(e)}catch(s){throw this.error=((a=(t=s.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to fetch tenant templates",console.error("Error fetching tenant templates:",s),s}finally{this.loading=!1}},async fetchTemplatesByType(e){var t,a;this.loading=!0,this.error=null;try{(await i.getByType(e)).forEach(r=>{const l=this.templates.findIndex(o=>o.templateId===r.templateId);l===-1?this.templates.push(r):this.templates[l]=r})}catch(s){throw this.error=((a=(t=s.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to fetch templates by type",console.error("Error fetching templates by type:",s),s}finally{this.loading=!1}},async fetchTemplateById(e){var t,a;this.loading=!0,this.error=null;try{return this.currentTemplate=await i.getById(e),this.currentTemplate}catch(s){throw this.error=((a=(t=s.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to fetch template",console.error("Error fetching template:",s),s}finally{this.loading=!1}},async fetchTemplateItems(e){var t,a;this.loading=!0,this.error=null;try{const s=await i.getItems(e);return this.templateItems[e]=s,s}catch(s){throw this.error=((a=(t=s.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to fetch template items",console.error("Error fetching template items:",s),s}finally{this.loading=!1}},async createTemplate(e){var t,a;this.loading=!0,this.error=null;try{const s=await i.create(e);return this.templates.push(s),s}catch(s){throw this.error=((a=(t=s.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to create template",console.error("Error creating template:",s),s}finally{this.loading=!1}},async addTemplateItems(e,t){var a,s;this.loading=!0,this.error=null;try{const r=await i.addItems(e,t);return this.templateItems[e]=r,r}catch(r){throw this.error=((s=(a=r.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to add template items",console.error("Error adding template items:",r),r}finally{this.loading=!1}},async updateTemplate(e,t){var a,s,r;this.loading=!0,this.error=null;try{const l=await i.update(e,t),o=this.templates.findIndex(p=>p.templateId===e);return o!==-1&&(this.templates[o]=l),((a=this.currentTemplate)==null?void 0:a.templateId)===e&&(this.currentTemplate=l),l}catch(l){throw this.error=((r=(s=l.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to update template",console.error("Error updating template:",l),l}finally{this.loading=!1}},async deactivateTemplate(e){var t,a,s;this.loading=!0,this.error=null;try{await i.deactivate(e);const r=this.templates.findIndex(l=>l.templateId===e);r!==-1&&(this.templates[r]={...this.templates[r],isActive:!1}),((t=this.currentTemplate)==null?void 0:t.templateId)===e&&(this.currentTemplate={...this.currentTemplate,isActive:!1})}catch(r){throw this.error=((s=(a=r.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to deactivate template",console.error("Error deactivating template:",r),r}finally{this.loading=!1}},clearError(){this.error=null}}});export{d as u};
