import{d as A,r as m,c as N,o as T,b as a,f as e,e as y,t as n,h as _,I as f,F,E as j,s as k,H as L,u as V,g as o,A as B}from"./vendor-8rVgzruD.js";import{b as p,a as $}from"./index-DcSKaWik.js";import{u as H,r as M}from"./XCircleIcon-CdsB511z.js";import{r as R}from"./BuildingOfficeIcon-BZlVraTP.js";import{r as E}from"./CheckIcon-CRwzpWK7.js";const O={async getAll(){return(await p.get("/tenants")).data},async getAvailable(){return(await p.get("/tenants/available")).data},async getById(r){return(await p.get(`/tenants/${r}`)).data},async create(r){return(await p.post("/tenants",r)).data},async update(r,d){return(await p.put(`/tenants/${r}`,d)).data}},U={class:"min-h-screen bg-gray-50 flex items-center justify-center p-4"},q={class:"max-w-2xl w-full"},D={class:"text-center mb-8"},P={class:"text-gray-600"},Y={class:"card"},G={class:"p-8"},J={key:0,class:"text-center py-12"},K={key:1,class:"alert-danger"},Q={class:"text-xs mt-1"},W={key:2,class:"space-y-3","data-testid":"tenant-list"},X=["data-tenant-id","onClick"],Z={class:"flex-shrink-0 mr-4"},ee={class:"w-12 h-12 rounded-lg bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center text-white font-semibold text-lg"},te={class:"flex-1 min-w-0"},se={class:"text-lg font-semibold text-gray-900 truncate"},ae={class:"text-sm text-gray-600"},oe={key:0,class:"ml-2 text-primary-600"},ne={class:"flex items-center gap-2 mt-1"},re={class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800"},ie={key:0,class:"text-xs text-gray-500"},le={class:"flex-shrink-0 ml-4"},de={key:0,class:"w-6 h-6 rounded-full bg-primary-600 flex items-center justify-center"},ce={key:1,class:"w-6 h-6 rounded-full border-2 border-gray-300 group-hover:border-primary-500"},ue={key:3,class:"text-center py-12"},me={key:4,class:"mt-8 flex gap-4"},pe=["disabled"],ge={key:0},ye={key:1,class:"flex items-center justify-center"},ve={key:0,class:"mt-6 text-center text-sm text-gray-600"},ke=A({__name:"TenantSelectorView",setup(r){const d=V(),b=L(),v=$(),C=H(),c=m([]),l=m(null),h=m(!1),g=m(!1),u=m(null),x=N(()=>v.isSystemAdmin),w=async()=>{var i,s;h.value=!0,u.value=null;try{c.value=await O.getAvailable(),c.value.length===1&&(l.value=c.value[0].tenantId)}catch(t){u.value=((s=(i=t.response)==null?void 0:i.data)==null?void 0:s.message)||"Failed to load organizations",console.error("Failed to load tenants:",t)}finally{h.value=!1}},S=i=>{l.value=i.tenantId},z=async()=>{var i,s;if(l.value){g.value=!0;try{v.setCurrentTenant(l.value),C.success("Organization selected successfully");const t=b.query.redirect||"/dashboard";d.push(t)}catch(t){u.value=((s=(i=t.response)==null?void 0:i.data)==null?void 0:s.message)||"Failed to select organization",console.error("Failed to select tenant:",t)}finally{g.value=!1}}},I=()=>{v.logout(),d.push("/login")};return T(()=>{w()}),(i,s)=>(o(),a("div",U,[e("div",q,[e("div",D,[s[0]||(s[0]=e("div",{class:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br from-primary-500 to-primary-600 shadow-glow mb-4"},[e("svg",{class:"w-10 h-10 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])],-1)),s[1]||(s[1]=e("h1",{class:"text-3xl font-display font-semibold text-gray-900 mb-2"}," Select Organization ",-1)),e("p",P,n(x.value?"Choose an organization to manage":"Select which organization to work with"),1)]),e("div",Y,[e("div",G,[h.value?(o(),a("div",J,[...s[2]||(s[2]=[e("div",{class:"spinner mx-auto mb-4"},null,-1),e("p",{class:"text-gray-600"}," Loading organizations... ",-1)])])):u.value?(o(),a("div",K,[_(f(M),{class:"h-5 w-5"}),e("div",null,[s[3]||(s[3]=e("p",{class:"text-sm font-medium"}," Failed to load organizations ",-1)),e("p",Q,n(u.value),1)]),e("button",{type:"button",class:"text-red-400 hover:text-red-600",onClick:w}," Retry ")])):c.value.length>0?(o(),a("div",W,[(o(!0),a(F,null,j(c.value,t=>(o(),a("div",{key:t.tenantId,class:B(["relative flex items-center p-4 border-2 border-gray-200 rounded-lg hover:border-primary-500 hover:bg-primary-50 cursor-pointer transition-all group",{"border-primary-500 bg-primary-50":l.value===t.tenantId}]),"data-tenant-id":t.tenantId,"data-testid":"tenant-card",onClick:he=>S(t)},[e("div",Z,[e("div",ee,n(t.tenantCode.substring(0,2).toUpperCase()),1)]),e("div",te,[e("h3",se,n(t.tenantName),1),e("p",ae,[k(" Code: "+n(t.tenantCode)+" ",1),t.roleName?(o(),a("span",oe," • "+n(t.roleName),1)):y("",!0)]),e("div",ne,[e("span",re,n(t.subscriptionTier),1),x.value?(o(),a("span",ie,n(t.maxUsers)+" users • "+n(t.maxLocations)+" locations ",1)):y("",!0)])]),e("div",le,[l.value===t.tenantId?(o(),a("div",de,[_(f(E),{class:"w-4 h-4 text-white"})])):(o(),a("div",ce))])],10,X))),128))])):(o(),a("div",ue,[_(f(R),{class:"w-16 h-16 mx-auto text-gray-400 mb-4"}),s[4]||(s[4]=e("p",{class:"text-gray-600 mb-2"}," No organizations available ",-1)),s[5]||(s[5]=e("p",{class:"text-sm text-gray-500"}," Please contact your administrator ",-1))])),c.value.length>0?(o(),a("div",me,[e("button",{disabled:!l.value||g.value,class:"btn-primary flex-1","data-testid":"continue-button",onClick:z},[g.value?(o(),a("span",ye,[...s[6]||(s[6]=[e("div",{class:"spinner mr-2"},null,-1),k(" Loading... ",-1)])])):(o(),a("span",ge,"Continue"))],8,pe),e("button",{class:"btn-outline","data-testid":"logout-button",onClick:I}," Logout ")])):y("",!0)])]),x.value?(o(),a("div",ve," You are logged in as a System Administrator ")):y("",!0)])]))}});export{ke as default};
