import{d as R,r as v,c as T,b as o,f as s,p as D,e as y,h as n,I as d,t as _,w as P,q as M,v as A,A as S,J as F,y as B,K as H,s as x,x as E,i as U,H as z,u as I,g as a}from"./vendor-8rVgzruD.js";import{a as W}from"./index-DcSKaWik.js";import{u as J,r as K}from"./XCircleIcon-CdsB511z.js";import{r as Y}from"./InformationCircleIcon-B2m1JJFM.js";import{r as G}from"./XMarkIcon-C76yCGqv.js";import{r as O,a as Q}from"./EnvelopeIcon-DDPJ4GH_.js";import{r as X,a as Z,b as ee}from"./LockClosedIcon-DHD7G0pt.js";const se={class:"min-h-screen bg-gray-50 flex items-center justify-center p-4"},te={class:"max-w-md w-full"},re={class:"card"},ae={class:"p-8"},oe={key:0,class:"alert-info mb-6"},le={key:1,class:"alert-danger mb-6","data-testid":"login-error"},ie={class:"text-sm font-medium"},ne={class:"relative"},de={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},ue={key:0,class:"form-error"},ce={class:"relative"},me={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},ve=["type"],pe={key:0,class:"form-error"},fe={class:"flex items-center justify-between"},ye={class:"flex items-center"},ge={class:"text-sm"},we=["disabled"],be={key:0},xe={key:1,class:"flex items-center justify-center"},he=["disabled"],ke={key:0},_e={key:1,class:"flex items-center justify-center"},Me={class:"mt-6 text-center"},qe={class:"mt-6 text-center"},$e=R({__name:"LoginView",setup(Ce){const g=I(),w=z(),p=W(),h=J(),r=v({email:"",password:"",rememberMe:!1}),b=v(!1),i=v(!1),f=v(null),u=v(null),c=v(null),q=T(()=>window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"),C=()=>(u.value=null,r.value.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.value.email)?!0:(u.value="Please enter a valid email address",!1):(u.value="Email is required",!1)),V=()=>(c.value=null,r.value.password?r.value.password.length<6?(c.value="Password must be at least 6 characters",!1):!0:(c.value="Password is required",!1)),L=()=>{const l=C(),e=V();return l&&e},k=()=>{f.value=null,p.clearError()},$=async()=>{var l,e;if(k(),!!L()){i.value=!0;try{if(await p.login({email:r.value.email,password:r.value.password}),h.success("Welcome back! Login successful."),p.needsTenantSelection){const t=w.query.redirect;g.push({name:"select-tenant",query:t?{redirect:t}:void 0})}else{const t=w.query.redirect||"/dashboard";g.push(t)}}catch(t){f.value=((e=(l=t.response)==null?void 0:l.data)==null?void 0:e.message)||"Login failed. Please check your credentials.",console.error("Login error:",t)}finally{i.value=!1}}},j=async()=>{var l,e;if(k(),!r.value.email){u.value="Email is required for dev login";return}i.value=!0;try{if(await p.devLogin(r.value.email),h.success("Dev login successful!"),p.needsTenantSelection){const t=w.query.redirect;g.push({name:"select-tenant",query:t?{redirect:t}:void 0})}else{const t=w.query.redirect||"/dashboard";g.push(t)}}catch(t){f.value=((e=(l=t.response)==null?void 0:l.data)==null?void 0:e.message)||"Dev login failed. Make sure dev mode is enabled on the server.",console.error("Dev login error:",t)}finally{i.value=!1}},N=()=>{h.info("Password reset functionality coming soon!")};return(l,e)=>{const t=U("router-link");return a(),o("div",se,[s("div",te,[e[13]||(e[13]=D('<div class="text-center mb-8"><div class="inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br from-primary-500 to-primary-600 shadow-glow mb-4"><svg class="w-10 h-10 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg></div><h1 class="text-3xl font-display font-semibold text-gray-900 mb-2"> Welcome Back </h1><p class="text-gray-600"> Sign in to your FireProof account </p></div>',1)),s("div",re,[s("div",ae,[q.value?(a(),o("div",oe,[n(d(Y),{class:"h-5 w-5"}),e[4]||(e[4]=s("div",null,[s("p",{class:"text-sm font-medium"}," Development Mode "),s("p",{class:"text-xs mt-1"}," You can use dev login (no password required) or register a test account ")],-1))])):y("",!0),f.value?(a(),o("div",le,[n(d(K),{class:"h-5 w-5"}),s("div",null,[s("p",ie,_(f.value),1)]),s("button",{type:"button",class:"text-red-400 hover:text-red-600","data-testid":"close-error",onClick:k},[n(d(G),{class:"h-5 w-5"})])])):y("",!0),s("form",{class:"space-y-6",onSubmit:P($,["prevent"])},[s("div",null,[e[5]||(e[5]=s("label",{for:"email",class:"form-label"}," Email Address ",-1)),s("div",ne,[s("div",de,[n(d(O),{class:"h-5 w-5 text-gray-400"})]),M(s("input",{id:"email","onUpdate:modelValue":e[0]||(e[0]=m=>r.value.email=m),type:"email",required:"",autocomplete:"email",class:S(["form-input pl-10",{"border-red-500 focus:ring-red-500":u.value}]),placeholder:"you@example.com","data-testid":"email-input",onBlur:C},null,34),[[A,r.value.email]])]),u.value?(a(),o("p",ue,_(u.value),1)):y("",!0)]),s("div",null,[e[6]||(e[6]=s("label",{for:"password",class:"form-label"}," Password ",-1)),s("div",ce,[s("div",me,[n(d(X),{class:"h-5 w-5 text-gray-400"})]),M(s("input",{id:"password","onUpdate:modelValue":e[1]||(e[1]=m=>r.value.password=m),type:b.value?"text":"password",required:"",autocomplete:"current-password",class:S(["form-input pl-10 pr-10",{"border-red-500 focus:ring-red-500":c.value}]),placeholder:"••••••••","data-testid":"password-input",onBlur:V},null,42,ve),[[F,r.value.password]]),s("button",{type:"button",class:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600","data-testid":"toggle-password-visibility",onClick:e[2]||(e[2]=m=>b.value=!b.value)},[b.value?(a(),B(d(ee),{key:1,class:"h-5 w-5"})):(a(),B(d(Z),{key:0,class:"h-5 w-5"}))])]),c.value?(a(),o("p",pe,_(c.value),1)):y("",!0)]),s("div",fe,[s("div",ye,[M(s("input",{id:"remember-me","onUpdate:modelValue":e[3]||(e[3]=m=>r.value.rememberMe=m),type:"checkbox",class:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded","data-testid":"remember-me-checkbox"},null,512),[[H,r.value.rememberMe]]),e[7]||(e[7]=s("label",{for:"remember-me",class:"ml-2 block text-sm text-gray-700"}," Remember me ",-1))]),s("div",ge,[s("a",{href:"#",class:"font-medium text-primary-600 hover:text-primary-500","data-testid":"forgot-password-link",onClick:P(N,["prevent"])}," Forgot password? ")])]),s("button",{type:"submit",disabled:i.value,class:"btn-primary w-full","data-testid":"login-submit-button"},[i.value?(a(),o("span",xe,[...e[8]||(e[8]=[s("div",{class:"spinner mr-2"},null,-1),x(" Signing in... ",-1)])])):(a(),o("span",be,"Sign In"))],8,we),q.value?(a(),o("button",{key:0,type:"button",disabled:i.value,class:"btn-outline w-full","data-testid":"dev-login-button",onClick:j},[i.value?(a(),o("span",_e,[...e[9]||(e[9]=[s("div",{class:"spinner mr-2"},null,-1),x(" Logging in... ",-1)])])):(a(),o("span",ke,"Dev Login (No Password)"))],8,he)):y("",!0)],32),e[11]||(e[11]=D('<div class="mt-6"><div class="relative"><div class="absolute inset-0 flex items-center"><div class="w-full border-t border-gray-300"></div></div><div class="relative flex justify-center text-sm"><span class="px-2 bg-white text-gray-500"> Don&#39;t have an account? </span></div></div></div>',1)),s("div",Me,[n(t,{to:"/register",class:"font-medium text-primary-600 hover:text-primary-500 transition-colors","data-testid":"register-link"},{default:E(()=>[...e[10]||(e[10]=[x(" Create a new account ",-1)])]),_:1})])])]),s("div",qe,[n(t,{to:"/",class:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900 transition-colors"},{default:E(()=>[n(d(Q),{class:"h-4 w-4 mr-2"}),e[12]||(e[12]=x(" Back to Home ",-1))]),_:1})])])])}}});export{$e as default};
