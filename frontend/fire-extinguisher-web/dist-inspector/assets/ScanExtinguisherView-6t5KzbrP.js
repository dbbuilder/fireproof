import{r as v,c as S,b as a,f as s,e as r,p as m,h as y,t as o,A as _,u as k,g as i}from"./vendor-8rVgzruD.js";import{u as w}from"./index-DcSKaWik.js";import{B as C}from"./BarcodeScannerComponent-BuGjwh93.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./barcode-DbNRVkGT.js";const N={class:"scan-extinguisher"},B={key:0,class:"instructions"},E={key:1,class:"scanner-container"},M={key:2,class:"extinguisher-info","data-testid":"extinguisher-info"},D={class:"info-card"},O={class:"info-row"},A={class:"info-value","data-testid":"extinguisher-type"},L={class:"info-row"},V={class:"info-value","data-testid":"extinguisher-serial"},z={class:"info-row"},R={class:"info-value","data-testid":"extinguisher-size"},P={class:"info-row"},Q={class:"info-value","data-testid":"extinguisher-last-service"},F={class:"status-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},T={key:0,d:"M9 12l2 2 4-4"},H={key:1,d:"M12 8v4M12 16h.01"},J={key:0,class:"info-card","data-testid":"location-context"},U={class:"info-row"},j={class:"info-value","data-testid":"context-location"},q={key:0,class:"info-row"},G={class:"info-value","data-testid":"context-building"},K={key:1,class:"info-row"},W={class:"info-value","data-testid":"context-floor"},X={key:3,class:"alert-error","data-testid":"scan-error"},Y={__name:"ScanExtinguisherView",setup(Z){const u=k(),d=w(),t=v(null),l=v(""),c=S(()=>d.currentLocation),p=async n=>{l.value="";try{let e;if(n.format==="QR_CODE")try{if(e=JSON.parse(n.text),e.type!=="extinguisher"||!e.extinguisherId)throw new Error("Invalid extinguisher QR code")}catch{throw new Error("Invalid QR code format. Please scan an extinguisher barcode.")}else e={type:"extinguisher",extinguisherId:n.text,serialNumber:n.text,extinguisherType:"ABC Dry Chemical",size:"10 lbs",status:"InService",lastServiceDate:"2024-06-15"};t.value=e,d.setCurrentExtinguisher({...e,scannedAt:new Date().toISOString()})}catch(e){l.value=e.message,t.value=null}},f=n=>{l.value=n.message||"Failed to scan barcode"},h=n=>n?new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",g=n=>({InService:"In Service",NeedsInspection:"Needs Inspection",OutOfService:"Out of Service"})[n]||n,x=()=>{u.push("/inspector/scan-location")},b=()=>{if(!t.value){l.value="Please scan an extinguisher first";return}u.push("/inspector/inspection-checklist")};return(n,e)=>(i(),a("div",N,[s("div",{class:"scan-header"},[s("button",{onClick:x,class:"btn-back","data-testid":"back-button"},[...e[0]||(e[0]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1)])]),e[1]||(e[1]=s("h1",{class:"scan-heading","data-testid":"page-heading"},"Scan Extinguisher",-1)),e[2]||(e[2]=s("div",{class:"header-spacer"},null,-1))]),t.value?r("",!0):(i(),a("div",B,[...e[3]||(e[3]=[m('<div class="instruction-icon" data-v-01ccc8ec><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" data-v-01ccc8ec><path d="M9 3v18M15 3v18M3 9h18M3 15h18" data-v-01ccc8ec></path></svg></div><p class="instruction-text" data-v-01ccc8ec>Scan the extinguisher barcode</p><p class="instruction-subtext" data-v-01ccc8ec>Position the barcode within the frame</p>',3)])])),t.value?r("",!0):(i(),a("div",E,[y(C,{onScanSuccess:p,onScanError:f,"data-testid":"barcode-scanner"})])),t.value?(i(),a("div",M,[e[15]||(e[15]=s("div",{class:"success-icon"},[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{d:"M22 11.08V12a10 10 0 11-5.93-9.14"}),s("polyline",{points:"22 4 12 14.01 9 11.01"})])],-1)),s("div",D,[e[8]||(e[8]=s("h2",{class:"info-heading"},"Extinguisher Details",-1)),s("div",O,[e[4]||(e[4]=s("span",{class:"info-label"},"Type:",-1)),s("span",A,o(t.value.type||"N/A"),1)]),s("div",L,[e[5]||(e[5]=s("span",{class:"info-label"},"Serial Number:",-1)),s("span",V,o(t.value.serialNumber||"N/A"),1)]),s("div",z,[e[6]||(e[6]=s("span",{class:"info-label"},"Size:",-1)),s("span",R,o(t.value.size||"N/A"),1)]),s("div",P,[e[7]||(e[7]=s("span",{class:"info-label"},"Last Service:",-1)),s("span",Q,o(h(t.value.lastServiceDate)),1)])]),s("div",{class:_(["status-badge",{"status-badge-pass":t.value.status==="InService","status-badge-warning":t.value.status==="NeedsInspection","status-badge-fail":t.value.status==="OutOfService"}]),"data-testid":"extinguisher-status"},[(i(),a("svg",F,[e[9]||(e[9]=s("circle",{cx:"12",cy:"12",r:"10"},null,-1)),t.value.status==="InService"?(i(),a("path",T)):(i(),a("path",H))])),s("span",null,o(g(t.value.status)),1)],2),c.value?(i(),a("div",J,[e[13]||(e[13]=s("h2",{class:"info-heading"},"Location Context",-1)),s("div",U,[e[10]||(e[10]=s("span",{class:"info-label"},"Location:",-1)),s("span",j,o(c.value.name),1)]),c.value.building?(i(),a("div",q,[e[11]||(e[11]=s("span",{class:"info-label"},"Building:",-1)),s("span",G,o(c.value.building),1)])):r("",!0),c.value.floor?(i(),a("div",K,[e[12]||(e[12]=s("span",{class:"info-label"},"Floor:",-1)),s("span",W,o(c.value.floor),1)])):r("",!0)])):r("",!0),s("button",{onClick:b,class:"btn-continue","data-testid":"continue-button"},[...e[14]||(e[14]=[s("span",null,"Continue to Inspection Checklist",-1),s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("path",{d:"M5 12h14M12 5l7 7-7 7"})],-1)])])])):r("",!0),l.value?(i(),a("div",X,[e[16]||(e[16]=s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("circle",{cx:"12",cy:"12",r:"10"}),s("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),s("line",{x1:"9",y1:"9",x2:"15",y2:"15"})],-1)),s("span",null,o(l.value),1)])):r("",!0)]))}},ie=I(Y,[["__scopeId","data-v-01ccc8ec"]]);export{ie as default};
